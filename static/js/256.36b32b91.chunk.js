"use strict";(self.webpackChunkpatanjali_koramangala=self.webpackChunkpatanjali_koramangala||[]).push([[256],{256:(e,a,t)=>{t.r(a),t.d(a,{default:()=>r});var l=t(555),o=t(43),s=t(216),n=t(722),c=t(579);const d="Radha";function r(){const[e,a]=(0,o.useState)(["All"]),[t,r]=(0,o.useState)(""),[i,p]=(0,o.useState)("All"),[u,m]=(0,o.useState)([]),g=(0,s.Zp)();(0,o.useEffect)(()=>{(async()=>{try{const e=(await n.A.get("http://localhost:5001/api/getImages")).data,t=[],l=new Set(["All"]);let o="Fetched Images:\n";for(const a in e){const s=e[a],n=a.replace("Radha/","")||"All";o+="\n\ud83d\udcc2 Folder: ".concat(n,"\n"),s.forEach(e=>{t.push({id:e.id,name:e.name,image:e.url,category:n,uploaded:!0,file:null}),o+=" - ".concat(e.name,"\n")}),l.add(n)}m(t),a([...l]),console.log("Fetched Cloudinary images:",t),alert(o)}catch(e){console.error("Failed to fetch Cloudinary images:",e),alert("Error fetching images. Check console for details.")}})()},[]);const h=e.reduce((e,a)=>(e[a]=u.filter(e=>e.category===a),e),{});return(0,c.jsxs)("div",{className:"p-8 bg-green-50 min-h-screen",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,c.jsx)("h1",{className:"text-2xl font-bold text-green-700",children:"Admin Dashboard"}),(0,c.jsx)("button",{onClick:()=>{g("/")},className:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600",children:"Logout"})]}),(0,c.jsxs)("div",{className:"flex gap-2 mb-4",children:[(0,c.jsx)("input",{value:t,onChange:e=>r(e.target.value),placeholder:"New Category",className:"border p-2 rounded w-64"}),(0,c.jsx)("button",{onClick:()=>{t&&!e.includes(t)&&(a([...e,t]),r(""))},className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"Add Category"})]}),(0,c.jsxs)("div",{className:"flex gap-2 mb-6",children:[(0,c.jsx)("select",{onChange:e=>p(e.target.value),className:"border p-2 rounded",value:i,children:e.map(e=>(0,c.jsx)("option",{children:e},e))}),(0,c.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{const a=e.target.files[0];if(!a)return;const t=new FileReader;t.onloadend=()=>{const e={id:Date.now(),name:a.name,price:"\u20b9100",qty:1,category:i,image:t.result,uploaded:!1,file:a};m(a=>[...a,e])},t.readAsDataURL(a)},className:"border p-2 rounded"})]}),u.some(e=>!e.uploaded)&&(0,c.jsx)("button",{onClick:async()=>{if(0===u.length)return alert("No images to upload!");const e=[...u],a={};e.forEach((e,t)=>{if(!e.uploaded&&e.file){var o;const s=(null===(o=e.category)||void 0===o?void 0:o.trim().replace(/\s+/g,"_"))||"Uncategorized";a[s]||(a[s]=[]),a[s].push((0,l.A)((0,l.A)({},e),{},{index:t}))}});for(const l in a){const r=a[l];for(const{file:a,name:i,index:p}of r)try{const t="".concat(d,"/").concat(l),o=i.replace(/\.[^/.]+$/,""),{data:s}=await n.A.get("http://localhost:5001/api/signature?folder=".concat(encodeURIComponent(t),"&public_id=").concat(encodeURIComponent(o))),{signature:c,timestamp:r,apiKey:u,cloudName:m}=s,g=new FormData;g.append("file",a),g.append("folder",t),g.append("public_id",o),g.append("api_key",u),g.append("timestamp",r),g.append("signature",c);const h=await n.A.post("https://api.cloudinary.com/v1_1/".concat(m,"/image/upload"),g);e[p].image=h.data.secure_url,e[p].uploaded=!0,console.log("\u2705 Uploaded successfully: ".concat(i," \u2192 ").concat(t))}catch(c){var t,o,s;const e=(null===(t=c.response)||void 0===t||null===(o=t.data)||void 0===o||null===(s=o.error)||void 0===s?void 0:s.message)||c.message;console.error("\u274c Failed to upload ".concat(i,": ").concat(e)),alert('Failed to upload "'.concat(i,'": ').concat(e))}}m(e),alert("\u2705 All images uploaded successfully!")},className:"mb-6 bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700",children:"Upload All to Cloudinary"}),e.map(e=>{var a;return(0,c.jsxs)("div",{className:"mb-8",children:[(0,c.jsx)("h2",{className:"text-xl font-semibold text-green-800 mb-3",children:e}),(0,c.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",children:null===(a=h[e])||void 0===a?void 0:a.map(e=>(0,c.jsxs)("div",{className:"p-4 bg-white rounded-xl shadow hover:shadow-lg transition",children:[e.image&&(0,c.jsx)("img",{src:e.image,alt:e.name,className:"w-full h-40 object-cover rounded mb-3"}),(0,c.jsx)("p",{className:"font-bold text-lg",children:e.name}),(0,c.jsx)("p",{className:"text-gray-600",children:e.price}),(0,c.jsxs)("p",{className:"text-gray-500",children:["Qty: ",e.qty]}),(0,c.jsxs)("p",{className:"text-sm text-green-700 mt-1",children:["Category: ",e.category]}),!e.uploaded&&(0,c.jsx)("span",{className:"text-xs text-orange-600",children:"Not uploaded"}),e.uploaded&&(0,c.jsx)("span",{className:"text-xs text-blue-600",children:"Uploaded"}),(0,c.jsx)("button",{onClick:()=>{return a=e.id,void m(u.filter(e=>e.id!==a));var a},className:"mt-3 bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600",children:"Delete"})]},e.id))})]},e)})]})}}}]);
//# sourceMappingURL=256.36b32b91.chunk.js.map
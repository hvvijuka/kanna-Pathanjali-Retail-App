"use strict";(self.webpackChunkpatanjali_koramangala=self.webpackChunkpatanjali_koramangala||[]).push([[460],{460:(e,a,r)=>{r.r(a),r.d(a,{default:()=>d});r(43);var s=r(169),t=r(729),n=r(216),c=r(862),l=r(579);function d(){const{cart:e,updateQty:a,remove:r,clear:d}=(0,s._)(),{user:i}=(0,t.A)(),o=(0,n.Zp)(),m=e.reduce((e,a)=>e+Number(a.price||0)*Number(a.qty||1),0);return(0,l.jsxs)("div",{className:"p-6 max-w-4xl mx-auto",children:[(0,l.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Your Cart"}),0===e.length?(0,l.jsx)("p",{children:"No items in cart"}):(0,l.jsxs)("div",{className:"bg-white p-4 rounded shadow",children:[e.map(e=>(0,l.jsxs)("div",{className:"flex items-center gap-4 border-b py-3",children:[(0,l.jsx)("img",{src:e.secure_url||e.image,alt:e.name,className:"w-20 h-20 object-cover rounded"}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("div",{className:"font-semibold",children:e.name}),(0,l.jsxs)("div",{className:"text-sm",children:["\u20b9",e.price]})]}),(0,l.jsx)("div",{children:(0,l.jsx)("input",{type:"number",value:e.qty,onChange:r=>a(e.id,Number(r.target.value||1)),className:"w-20 border p-1 rounded"})}),(0,l.jsxs)("div",{className:"w-24",children:["\u20b9",Number(e.price||0)*Number(e.qty||1)]}),(0,l.jsx)("button",{onClick:()=>r(e.id),className:"text-red-500",children:"Remove"})]},e.id)),(0,l.jsxs)("div",{className:"flex justify-between items-center mt-4",children:[(0,l.jsxs)("div",{className:"font-bold",children:["Total: \u20b9",m]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("button",{onClick:()=>o("/user"),className:"px-3 py-1 border rounded",children:"Continue"}),(0,l.jsx)("button",{onClick:async()=>{if(0===e.length)return alert("Cart empty");const a=e.map(e=>e.secure_url||e.image||""),r=e.reduce((e,a)=>e+Number(a.price||0)*Number(a.qty||1),0),s={userId:(null===i||void 0===i?void 0:i._id)||"demo",username:(null===i||void 0===i?void 0:i.username)||"Guest User",address:(null===i||void 0===i?void 0:i.address)||"Not provided",items:e.map(e=>({id:e.id,name:e.name,qty:e.qty,price:e.price,image:e.secure_url||e.image||""})),totalAmount:r,paymentMethod:"COD",cashCollected:0,images:a};try{alert("calling backend: ");const e=await c.w(s);alert("Order placed successfully! ID: "+e._id),d(),o("/orders")}catch(t){console.error("Error placing order:",t),alert("Failed to place order. Please try again.")}},className:"px-3 py-1 bg-green-600 text-white rounded",children:"Place Order (COD)"})]})]})]})]})}},862:(e,a,r)=>{r.d(a,{m:()=>n,w:()=>t});const s="http://localhost:5001",t=async e=>{const a=await fetch("".concat(s,"/api/placeOrder"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!a.ok)throw new Error("Failed to place order");return await a.json()};async function n(e){const a=await fetch("".concat(s,"/api/getOrders/").concat(e));if(!a.ok)throw new Error("Failed to get orders");return a.json()}}}]);
//# sourceMappingURL=460.4791e18b.chunk.js.map
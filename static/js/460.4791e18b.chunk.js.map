{"version":3,"file":"static/js/460.4791e18b.chunk.js","mappings":"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","sources":["components/CartPage.js","utils/api.js"],"sourcesContent":["\r\n// -----------------------------\r\n// File: src/components/CartPage.js\r\n// -----------------------------\r\nimport React from 'react';\r\nimport { useCart } from '../context/CartContext';\r\nimport { useAuth } from '../context/AuthContext';\r\n// import api from '../utils/api';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport * as api from \"../utils/api\";\r\n\r\nexport default function CartPage(){\r\n  const { cart, updateQty, remove, clear } = useCart();\r\n  const { user } = useAuth();\r\n  const navigate = useNavigate();\r\n\r\n  const total = cart.reduce((s,i)=> s + (Number(i.price||0) * Number(i.qty||1)), 0);\r\n\r\nconst placeOrder = async () => {\r\n  if (cart.length === 0) return alert(\"Cart empty\");\r\n\r\n  // Prepare image URLs from cart\r\n  const imageUrls = cart.map(item => item.secure_url || item.image || \"\");\r\n\r\n  // Compute total cost\r\n  const total = cart.reduce(\r\n    (sum, item) => sum + Number(item.price || 0) * Number(item.qty || 1),\r\n    0\r\n  );\r\n\r\n  // Prepare payload\r\n  const payload = {\r\n    userId: user?._id || \"demo\",\r\n    username: user?.username || \"Guest User\",\r\n    address: user?.address || \"Not provided\",\r\n    items: cart.map(item => ({\r\n      id: item.id,\r\n      name: item.name,\r\n      qty: item.qty,\r\n      price: item.price,\r\n      image: item.secure_url || item.image || \"\",\r\n    })),\r\n    totalAmount: total,\r\n    paymentMethod: \"COD\",\r\n    cashCollected: 0,\r\n    images: imageUrls, // all image URLs in one array\r\n  };\r\n\r\n  try {\r\n    alert(\"calling backend: \");\r\n    const res = await api.placeOrder(payload);\r\n    alert(\"Order placed successfully! ID: \" + res._id);\r\n\r\n    // clear cart\r\n    clear();\r\n    navigate(\"/orders\");\r\n  } catch (err) {\r\n    console.error(\"Error placing order:\", err);\r\n    alert(\"Failed to place order. Please try again.\");\r\n  }\r\n};\r\n\r\n\r\n  return (\r\n    <div className=\"p-6 max-w-4xl mx-auto\">\r\n      <h2 className=\"text-2xl font-bold mb-4\">Your Cart</h2>\r\n      {cart.length===0 ? <p>No items in cart</p> : (\r\n        <div className=\"bg-white p-4 rounded shadow\">\r\n          {cart.map(i=> (\r\n            <div key={i.id} className=\"flex items-center gap-4 border-b py-3\">\r\n              <img src={i.secure_url || i.image} alt={i.name} className=\"w-20 h-20 object-cover rounded\" />\r\n              <div className=\"flex-1\">\r\n                <div className=\"font-semibold\">{i.name}</div>\r\n                <div className=\"text-sm\">₹{i.price}</div>\r\n              </div>\r\n              <div>\r\n                <input type=\"number\" value={i.qty} onChange={(e)=> updateQty(i.id, Number(e.target.value||1))} className=\"w-20 border p-1 rounded\" />\r\n              </div>\r\n              <div className=\"w-24\">₹{Number(i.price||0) * Number(i.qty||1)}</div>\r\n              <button onClick={()=> remove(i.id)} className=\"text-red-500\">Remove</button>\r\n            </div>\r\n          ))}\r\n\r\n          <div className=\"flex justify-between items-center mt-4\">\r\n            <div className=\"font-bold\">Total: ₹{total}</div>\r\n            <div className=\"flex gap-2\">\r\n              <button onClick={()=> navigate('/user')} className=\"px-3 py-1 border rounded\">Continue</button>\r\n              <button onClick={placeOrder} className=\"px-3 py-1 bg-green-600 text-white rounded\">Place Order (COD)</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","const BACKEND_URL =\r\n  process.env.REACT_APP_BACKEND_URL ||\r\n  (window.location.hostname === \"localhost\"\r\n    ? \"http://localhost:5001\"\r\n    : \"https://rk-backend-cxfa.onrender.com\");\r\n\r\n// Place order API\r\nexport const placeOrder = async (payload) => {\r\n  const res = await fetch(`${BACKEND_URL}/api/placeOrder`, {\r\n    method: \"POST\",\r\n    headers: { \"Content-Type\": \"application/json\" },\r\n    body: JSON.stringify(payload),\r\n  });\r\n  if (!res.ok) throw new Error(\"Failed to place order\");\r\n  return await res.json();\r\n};\r\n\r\n\r\nexport async function getOrdersByUser(userId) {\r\n  const res = await fetch(`${BACKEND_URL}/api/getOrders/${userId}`);\r\n  if (!res.ok) throw new Error(\"Failed to get orders\");\r\n  return res.json();\r\n}"],"names":["CartPage","cart","updateQty","remove","clear","useCart","user","useAuth","navigate","useNavigate","total","reduce","s","i","Number","price","qty","_jsxs","className","children","_jsx","length","map","src","secure_url","image","alt","name","type","value","onChange","e","id","target","onClick","async","alert","imageUrls","item","sum","payload","userId","_id","username","address","items","totalAmount","paymentMethod","cashCollected","images","res","api","err","console","error","BACKEND_URL","process","placeOrder","fetch","concat","method","headers","body","JSON","stringify","ok","Error","json","getOrdersByUser"],"sourceRoot":""}